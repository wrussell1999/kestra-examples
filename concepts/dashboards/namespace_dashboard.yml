id: data_dashboard
title: Data Dashboard
description: Dashboard for kestra.data namespace

timeWindow:
  default: P7D
  max: P365D

charts:
  - id: total_executions_timeseries
    type: io.kestra.plugin.core.dashboard.chart.TimeSeries
    chartOptions:
      description: Executions duration and count per date
      displayName: Total Executions
      legend:
        enabled: true
      column: date
      colorByColumn: state
      width: 9
    data:
      type: io.kestra.plugin.core.dashboard.data.Executions
      columns:
        date:
          field: START_DATE
          displayName: Date
        state:
          field: STATE
        total:
          displayName: Executions
          agg: COUNT
          graphStyle: BARS
      where:
        - type: IN
          field: NAMESPACE
          values:
            - kestra.data

  - id: kpi_success_ratio
    type: io.kestra.plugin.core.dashboard.chart.KPI
    chartOptions:
      displayName: Success Ratio
      numberType: PERCENTAGE
      width: 3
    data:
      type: io.kestra.plugin.core.dashboard.data.ExecutionsKPI
      columns:
        field: ID
        agg: COUNT
      numerator:
        - type: IN
          field: STATE
          values:
            - SUCCESS
      where:  
        - type: IN
          field: NAMESPACE
          values:
            - kestra.data

  - id: total_executions_pie
    type: io.kestra.plugin.core.dashboard.chart.Pie
    chartOptions:
      displayName: Total Executions
      graphStyle: DONUT
      tooltip: ALL
      width: 3
    data:
      type: io.kestra.plugin.core.dashboard.data.Executions
      columns:
        id:
          field: ID
          displayName: Execution Id
          agg: COUNT
        state:
          field: STATE
          displayName: State
      where:  
        - type: IN
          field: NAMESPACE
          values:
            - kestra.data

  - id: executions_in_progress
    type: io.kestra.plugin.core.dashboard.chart.Table
    chartOptions:
      displayName: Executions In Progress
      pagination:
        enabled: true
      width: 6
    data:
      type: io.kestra.plugin.core.dashboard.data.Executions
      columns:
        id:
          field: ID
          displayName: Execution ID
        namespace:
          field: NAMESPACE
          displayName: Namespace
        flow:
          field: FLOW_ID
          displayName: Flow
        start_date:
          field: START_DATE
          displayName: Start Date
        state:
          field: STATE
          displayName: State
      where:
        - type: IN
          field: STATE
          values:
            - CREATED
            - RESTARTED
            - QUEUED
            - RUNNING
            - PAUSED
            - RETRYING
            - KILLING
        - type: IN
          field: NAMESPACE
          values:
            - kestra.data

  - id: next_executions
    type: io.kestra.plugin.core.dashboard.chart.Table
    chartOptions:
      displayName: Next Executions
      pagination:
        enabled: true
      width: 6
    data:
      type: io.kestra.plugin.core.dashboard.data.Triggers
      columns:
        namespace:
          field: NAMESPACE
          displayName: Namespace
        flowId:
          field: FLOW_ID
          displayName: Flow
        nextExec:
          field: NEXT_EXECUTION_DATE
          displayName: Next Execution Date
      where:
        - type: IN
          field: NAMESPACE
          values:
            - kestra.data
